// 1
SELECT p.*, s.*
	FROM products_suppliers ps
	JOIN products p ON ps.productID = p.productID
	JOIN suppliers s ON ps.supplierID = s.supplierID
	WHERE s.name = 'ABC Traders';

// 2
SELECT SUM(p.quantity * p.price) AS `Total cost`
	FROM products_suppliers ps
	JOIN products p ON ps.productID = p.productID
	JOIN suppliers s ON ps.supplierID = s.supplierID
	WHERE s.name IN('XYZ Company', 'QQ Corp');

// 3
SELECT s.supplierID AS 'Supplier',
// 		  s.name AS 'Name',
		CAST(SUM(p.price * p.quantity) / SUM(p.quantity) AS DECIMAL(7, 2)) AS `Average price`
	FROM products_suppliers ps
    JOIN products p ON ps.productID = p.productID
    JOIN suppliers s ON ps.supplierID = s.supplierID
	GROUP BY s.supplierID;
// 	  ORDER BY `Average price`;

// 4
SELECT s.name AS `Supplier Name`,
		s.phone AS `Supplier Phone`,
		p.price AS `Min Product Price`
	FROM products_suppliers ps
	JOIN products p ON ps.productID = p.productID
	JOIN suppliers s ON ps.supplierID = s.supplierID
	WHERE p.productCode = 'MRK'
	ORDER BY p.price
	LIMIT 1;

// *5
SELECT s.name AS `Supplier Name`,
		s.phone AS `Supplier Phone`,
		COUNT(DISTINCT(p.productCode)) AS `Number of Product Codes`
	FROM products_suppliers ps
    JOIN products p ON ps.productID = p.productID
    JOIN suppliers s ON ps.supplierID = s.supplierID
	GROUP BY s.supplierID
	ORDER BY 3 DESC
	LIMIT 1;
